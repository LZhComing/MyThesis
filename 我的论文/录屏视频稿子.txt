大家好，我是电子信息科学与技术1班的郑智聪。我的论文题目叫做物联网网关轻量级认证和加密技术研究。
我的毕业设计主要是提出了一种物联网网关与云服务器之间秘钥协商和数据加密的方案，并且将椭圆曲线和AES加密算法应用到了实际项目中
毕设的整个系统由三个部分组成，分别为服务端，网关客户端和Web客户端，下面我将展示一下整个系统的一些核心功能

1. 秘钥协商
秘钥协商的过程需要经过四次“握手”，八个步骤
首先启动云服务器端，这时候云服务器端会初始化自己的公钥和私钥
然后启动网关客户端，网关会去连接服务端，第一步：当连接建立时，向服务端发送秘钥协商请求，并且把自己的公钥发送给服务端，这是第一次握手
服务端接收到秘钥协商请求之后，拿网关的公钥和自己的私钥进行秘钥协商，并且把协商出的秘钥保存在一个HashMap的数据结构，然后将自己的公钥发送给网关，这是第二次握手
网关接收到服务器的公钥，使用自己的私钥和服务器的公钥进行秘钥协商，把协商出来的秘钥保存起来，然后使用这个秘钥加密登录口令，跟服务器验证自己秘钥的正确性，这是第三次握手
服务器接收到加密的登录口令之后，拿网关对应的秘钥进行解密，然后与事先定好的登录口令对比，通过之后就会向网关发送登录成功的消息，这是第四次握手，至此算是秘钥协商完成

可以看到，在整个秘钥协商的过程中，只有双方的公钥在网络中进行了传输，然后又因为椭圆曲线的离散对数问题，根本不可能由公钥计算出私钥，所以也就没有办法窃取加密的秘钥，整个通信信道就是安全的

2. 数据加密解密和数字签名
秘钥协商完成，网关登录成功之后，后续通信的数据都会加密并且附加上数字签名，可以看到，发送方在发送数据时，先使用自己的私钥进行数字签名，然后再进行AES128加密。接收方接收数据时，先使用发送方的公钥
进行验证数字签名，验签通过之后，才会对数据进行解密。

3.心跳管理
网关登录成功之后，双方加入心跳管理机制，通过不断地向对方发送心跳和应答，确保通信双方在线。
服务端的逻辑是：如果网关三次心跳都没有应答，就会标记网关下线，然后关闭网关的信道
网关客户端的逻辑是：如果服务端三次心跳都没有应答，判断服务器宕机，然后开启定时任务进行重连

4.刷新秘钥
用户可以在Web客户端登录用户管理中心，然后可以看到在线的网关，每一个网关后面都有一个刷新秘钥的按钮，用户点击刷新秘钥按钮之后，服务端会向网关客户端发送刷新秘钥的指令，
然后网关客户端重新生成私钥和公钥，执行秘钥协商和网关登录的步骤，